"use strict";var cov_1rz8luofkx=function(){var path="C:\\Users\\Adeola PC\\Desktop\\BootCamp\\Banka\\server\\build\\utils\\transactionLogic.js";var hash="31a750882a994affe4a8c6084d4c67822bad2356";var Function=function(){}.constructor;var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\Adeola PC\\Desktop\\BootCamp\\Banka\\server\\build\\utils\\transactionLogic.js",statementMap:{"0":{start:{line:3,column:0},end:{line:5,column:3}},"1":{start:{line:6,column:0},end:{line:6,column:26}},"2":{start:{line:8,column:20},end:{line:8,column:58}},"3":{start:{line:10,column:21},end:{line:10,column:58}},"4":{start:{line:12,column:39},end:{line:12,column:93}},"5":{start:{line:21,column:12},end:{line:63,column:1}},"6":{start:{line:22,column:16},end:{line:22,column:101}},"7":{start:{line:23,column:15},end:{line:23,column:42}},"8":{start:{line:25,column:2},end:{line:30,column:3}},"9":{start:{line:26,column:4},end:{line:29,column:7}},"10":{start:{line:32,column:2},end:{line:37,column:3}},"11":{start:{line:33,column:4},end:{line:36,column:7}},"12":{start:{line:38,column:2},end:{line:43,column:3}},"13":{start:{line:39,column:4},end:{line:42,column:7}},"14":{start:{line:45,column:19},end:{line:45,column:52}},"15":{start:{line:46,column:30},end:{line:46,column:31}},"16":{start:{line:47,column:11},end:{line:47,column:60}},"17":{start:{line:48,column:18},end:{line:48,column:38}},"18":{start:{line:49,column:13},end:{line:49,column:46}},"19":{start:{line:50,column:18},end:{line:50,column:46}},"20":{start:{line:51,column:20},end:{line:51,column:59}},"21":{start:{line:52,column:2},end:{line:52,column:100}},"22":{start:{line:54,column:2},end:{line:56,column:63}},"23":{start:{line:58,column:23},end:{line:58,column:69}},"24":{start:{line:59,column:2},end:{line:62,column:5}}},fnMap:{"0":{name:"_interopRequireDefault",decl:{start:{line:12,column:9},end:{line:12,column:31}},loc:{start:{line:12,column:37},end:{line:12,column:95}},line:12},"1":{name:"logic",decl:{start:{line:21,column:37},end:{line:21,column:42}},loc:{start:{line:21,column:61},end:{line:63,column:1}},line:21}},branchMap:{"0":{loc:{start:{line:12,column:46},end:{line:12,column:92}},type:"cond-expr",locations:[{start:{line:12,column:70},end:{line:12,column:73}},{start:{line:12,column:76},end:{line:12,column:92}}],line:12},"1":{loc:{start:{line:12,column:46},end:{line:12,column:67}},type:"binary-expr",locations:[{start:{line:12,column:46},end:{line:12,column:49}},{start:{line:12,column:53},end:{line:12,column:67}}],line:12},"2":{loc:{start:{line:25,column:2},end:{line:30,column:3}},type:"if",locations:[{start:{line:25,column:2},end:{line:30,column:3}},{start:{line:25,column:2},end:{line:30,column:3}}],line:25},"3":{loc:{start:{line:32,column:2},end:{line:37,column:3}},type:"if",locations:[{start:{line:32,column:2},end:{line:37,column:3}},{start:{line:32,column:2},end:{line:37,column:3}}],line:32},"4":{loc:{start:{line:38,column:2},end:{line:43,column:3}},type:"if",locations:[{start:{line:38,column:2},end:{line:43,column:3}},{start:{line:38,column:2},end:{line:43,column:3}}],line:38},"5":{loc:{start:{line:38,column:6},end:{line:38,column:52}},type:"binary-expr",locations:[{start:{line:38,column:6},end:{line:38,column:19}},{start:{line:38,column:23},end:{line:38,column:52}}],line:38},"6":{loc:{start:{line:49,column:13},end:{line:49,column:46}},type:"cond-expr",locations:[{start:{line:49,column:28},end:{line:49,column:36}},{start:{line:49,column:39},end:{line:49,column:46}}],line:49},"7":{loc:{start:{line:50,column:18},end:{line:50,column:46}},type:"binary-expr",locations:[{start:{line:50,column:18},end:{line:50,column:36}},{start:{line:50,column:40},end:{line:50,column:46}}],line:50},"8":{loc:{start:{line:51,column:20},end:{line:51,column:59}},type:"binary-expr",locations:[{start:{line:51,column:20},end:{line:51,column:49}},{start:{line:51,column:53},end:{line:51,column:59}}],line:51}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_1rz8luofkx.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});cov_1rz8luofkx.s[1]++;exports.logic=undefined;var _dbController=(cov_1rz8luofkx.s[2]++,require("../controllers/dbController"));var _dbController2=(cov_1rz8luofkx.s[3]++,_interopRequireDefault(_dbController));function _interopRequireDefault(obj){cov_1rz8luofkx.f[0]++;cov_1rz8luofkx.s[4]++;return(cov_1rz8luofkx.b[1][0]++,obj)&&(cov_1rz8luofkx.b[1][1]++,obj.__esModule)?(cov_1rz8luofkx.b[0][0]++,obj):(cov_1rz8luofkx.b[0][1]++,{default:obj});}/**
 * Debit or Credit controller
 * @param {number} action - positve for credit, negative for debit
 * @param {obj} req - request from body
 * @param {obj} res - response to request from body
 * @return {obj}    - returns response object
 */var logic=(cov_1rz8luofkx.s[5]++,exports.logic=function logic(action,req,res){cov_1rz8luofkx.f[1]++;var account=(cov_1rz8luofkx.s[6]++,_dbController2.default.findAccountByAccountNumber(parseInt(req.params.accountNumber)));var amount=(cov_1rz8luofkx.s[7]++,parseFloat(req.body.amount));cov_1rz8luofkx.s[8]++;if(!account){cov_1rz8luofkx.b[2][0]++;cov_1rz8luofkx.s[9]++;return res.status(400).json({status:400,error:"Invalid Account Number"});}else{cov_1rz8luofkx.b[2][1]++;}cov_1rz8luofkx.s[10]++;if(account.status==="dormant"){cov_1rz8luofkx.b[3][0]++;cov_1rz8luofkx.s[11]++;return res.status(400).json({status:400,error:"Account is Inactive"});}else{cov_1rz8luofkx.b[3][1]++;}cov_1rz8luofkx.s[12]++;if((cov_1rz8luofkx.b[5][0]++,action===-1)&&(cov_1rz8luofkx.b[5][1]++,account.balance-amount<=0)){cov_1rz8luofkx.b[4][0]++;cov_1rz8luofkx.s[13]++;return res.status(400).json({status:400,error:"Low Funds. Account cant be Debited"});}else{cov_1rz8luofkx.b[4][1]++;}var newBalance=(cov_1rz8luofkx.s[14]++,account.balance+amount*action);var lengthOfTransactionId=(cov_1rz8luofkx.s[15]++,6);var id=(cov_1rz8luofkx.s[16]++,Math.floor(Math.random()*lengthOfTransactionId));var createdOn=(cov_1rz8luofkx.s[17]++,new Date(Date.now()));var type=(cov_1rz8luofkx.s[18]++,action===1?(cov_1rz8luofkx.b[6][0]++,"credit"):(cov_1rz8luofkx.b[6][1]++,"debit"));var depositor=(cov_1rz8luofkx.s[19]++,(cov_1rz8luofkx.b[7][0]++,req.body.depositor)||(cov_1rz8luofkx.b[7][1]++,"self"));var phoneNumber=(cov_1rz8luofkx.s[20]++,(cov_1rz8luofkx.b[8][0]++,req.body.depositorPhoneNumber)||(cov_1rz8luofkx.b[8][1]++,"self"));cov_1rz8luofkx.s[21]++;_dbController2.default.updateAccountDB(parseInt(req.params.accountNumber),"balance",newBalance);cov_1rz8luofkx.s[22]++;_dbController2.default.createTransaction(id,createdOn,type,req.params.accountNumber,// req.userData.id,
amount,account.balance,newBalance,depositor,phoneNumber);var newTransaction=(cov_1rz8luofkx.s[23]++,_dbController2.default.findTransactionById(id));cov_1rz8luofkx.s[24]++;return res.status(200).json({status:200,data:newTransaction});});